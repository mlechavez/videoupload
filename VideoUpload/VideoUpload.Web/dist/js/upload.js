!function(a,t,d){var e={frmUpload:a("#frmUpload"),appModal:a("#appModal"),videoFile:a("#Attachment"),videoImage:a("#VideoImage"),btnSubmit:a("#btnSubmit"),modalContent:a("#appModal .modal-content"),mceContainer:a(".mce-container")};t.init=function(){d.init({selector:"#Description",branding:!1,menubar:!1,toolbar:!1,statusbar:!1,content_css:"../../dist/css/app.min.css"}),a(".mce-container").addClass(".mce-conatiner-custom"),o()};var o=function(){e.frmUpload.on("submit",function(t){function d(t){var d=e.appModal.find(".modal-title"),o=e.appModal.find(".progress-bar"),n=e.appModal.find(".modal-content");d.html(t),o.css("width","100%").removeClass("active").html("100%"),e.btnSubmit.removeClass("disabled").html("Upload");var i=a("<div></div>").addClass("modal-footer"),s=a("<button></button>").addClass("btn btn-primary pull-right").attr({id:"btnUploadExit","data-status":"success"}).html("Close");i.append(s),n.append(i)}function o(t){var d=e.appModal.find(".modal-title"),o=e.appModal.find(".modal-body"),n=e.appModal.find(".modal-content");d.html("Upload failed"),o.empty(),o.append('<p class="text-center">'+t+"</p>"),e.btnSubmit.removeClass("disabled").html("Upload");var i=a("<div></div>").addClass("modal-footer"),s=a("<button></button>").addClass("btn btn-primary pull-right").attr({id:"btnUploadExit","data-status":"failed"}).html("Close");i.append(s),n.append(i)}t.preventDefault();var n=a(this),i=e.videoFile.get(0).files[0],s=e.videoImage.get(0).files[0],l=new FormData;l.append("Attachment",i),l.append("VideoImage",s),a("input[type='text'").each(function(t,d){l.append(a(d).attr("name"),a(d).val())}),l.append("Description",tinyMCE.activeEditor.getContent({format:"raw"})),e.appModal.modal({keyboard:!1,backdrop:"static"}),e.appModal.modal("show");var p=new XMLHttpRequest;p.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.responseText);a.success?d(a.message):o(a.message)}},p.upload.addEventListener("progress",function(t){var d=t.loaded/t.total,o=Math.floor(100*d).toString()+"%";progressBar=e.appModal.find(".progress-bar"),progressBar.css("width",o).addClass("progress-bar-striped active").html(o),"100%"===o&&e.appModal.find(".modal-title").html("Please wait for a few moment to complete. Please do not interrupt"),a("#btnSubmit").html("<i class='fa fa-spin'></i>Loading...").addClass("disabled")}),p.open("post",n.attr("action"),!0),p.send(l)}),e.appModal.on("show.bs.modal",function(){var t=a(this),d=t.find(".modal-title"),e=t.find(".close"),o=t.find(".modal-body");d.html("Upload in progress"),e.addClass("hidden"),o.empty();var n=a("<div></div>");n.addClass("progress");var i=a("<div></div>");i.addClass("progress-bar"),n.append(i),o.append(n)}),e.modalContent.on("click","#btnUploadExit",function(){if("success"===a(this).data("status")){var t=location.href.toLowerCase();location.href=t.replace("/videos/upload","")}else e.appModal.modal("hide")}),e.appModal.on("hidden.bs.modal",function(){var t=a(this);t.find(".modal-body").empty(),t.find(".modal-footer").remove()})}}(jQuery,window.UploadWidget=window.UploadWidget||{},tinymce),UploadWidget.init();